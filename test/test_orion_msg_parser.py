import unittest
import pandas as pd
pd.set_option('display.max_columns', None)
pd.set_option('display.expand_frame_repr', False)
pd.set_option('max_colwidth', -1)
pd.set_option('display.precision', 2)
from orion_msg_parser import *

class TestUtil(unittest.TestCase):
    def test_parser_space_xml(self):
        input_xml_str1 = """[ucl]16350.0[/ucl][lcl]13950.0[/lcl][s]2874325510[/s][l]9607481.001[/l][w]7481-07[/w][mv]14466.904[/mv][v]true[/v][s]2871997204[/s][l]9609341.001[/l][w]9341-15[/w][mv]14275.58[/mv][v]true[/v][s]2870871069[/s][l]9611411.051[/l][w]1411-23[/w][mv]16005.8833333333[/mv][v]true[/v][s]2870871068[/s][l]9611411.051[/l][w]1411-14[/w][mv]16294.2[/mv][v]true[/v][s]2869786011[/s][l]9611411.041[/l][w]1411-15[/w][mv]16586.8363636364[/mv][v]true[/v][s]2869786010[/s][l]9611411.041[/l][w]1411-25[/w][mv]16511.7083333333[/mv][v]true[/v][s]2866405823[/s][l]9545311.001[/l][w]5311-02[/w][mv]15741.975[/mv][v]true[/v][s]2866405822[/s][l]9545311.001[/l][w]5311-03[/w][mv]15630.39[/mv][v]true[/v][s]2861921469[/s][l]9605481.091[/l][w]5481-07[/w][mv]15948.5211538462[/mv][v]true[/v][s]2861921468[/s][l]9605481.091[/l][w]5481-06[/w][mv]16035.1076923077[/mv][v]true[/v][s]2861531805[/s][l]9582571.001[/l][w]2571-06[/w][mv]13921.0181818182[/mv][v]true[/v][s]2861531804[/s][l]9582571.001[/l][w]2571-15[/w][mv]14122.0333333333[/mv][v]true[/v][s]2861531803[/s][l]9582571.001[/l][w]2571-05[/w][mv]14128.3583333333[/mv][v]true[/v][s]2861531802[/s][l]9582571.001[/l][w]2571-04[/w][mv]14158.8727272727[/mv][v]true[/v][s]2861531801[/s][l]9582571.001[/l][w]2571-09[/w][mv]14145.1363636364[/mv][v]true[/v][s]2861132512[/s][l]9582571.001[/l][w]2571-06[/w][mv]13955.5833333333[/mv][v]true[/v][s]2874388043[/s][l]9609331.001[/l][w]9331-13[/w][mv]14825.1469387755[/mv][v]false[/v][s]2874388042[/s][l]9609331.001[/l][w]9331-15[/w][mv]15152.484[/mv][v]false[/v][s]2874388041[/s][l]9609331.001[/l][w]9331-16[/w][mv]14858.1897959184[/mv][v]false[/v][s]2874388040[/s][l]9609331.001[/l][w]9331-14[/w][mv]15081.95[/mv][v]false[/v][s]2874325511[/s][l]9607481.001[/l][w]7481-08[/w][mv]14559.216[/mv][v]false[/v][s]2874325509[/s][l]9607481.001[/l][w]7481-06[/w][mv]14515.4408163265[/mv][v]false[/v][s]2874325508[/s][l]9607481.001[/l][w]7481-05[/w][mv]14624.2411764706[/mv][v]false[/v][s]2874273756[/s][l]9611411.001[/l][w]1411-17[/w][mv]15008.3818181818[/mv][v]false[/v][s]2874273755[/s][l]9611411.001[/l][w]1411-24[/w][mv]15089.7666666667[/mv][v]false[/v][s]2874273754[/s][l]9611411.001[/l][w]1411-13[/w][mv]15145.0416666667[/mv][v]false[/v][s]2874273753[/s][l]9611411.001[/l][w]1411-16[/w][mv]15243.8166666667[/mv][v]false[/v][s]2874273752[/s][l]9611411.001[/l][w]1411-18[/w][mv]15234.3083333333[/mv][v]false[/v][s]2873758678[/s][l]9607481.051[/l][w]7481-02[/w][mv]14640.6264150943[/mv][v]false[/v][s]2873758677[/s][l]9607481.051[/l][w]7481-01[/w][mv]14684.293877551[/mv][v]false[/v]"""
        input_xml_str2 = """[fab]F10N[/fab][module]F10 PHOTO[/module][did]B27B[/did][chId]733608[/chId][ckcId]1[/ckcId][violid]35[/violid][para]BIAS_CD2_CD1_SPACE_BOT[/para][p]3010-52 WL PHOTO[/p][m]1210-52 WL PHOTO SEM CD[/m]"""
        input_xml_str3 = """[t]1[/t][d]2018-12-06 03:26:59.0[/d][t]1[/t][d]2018-12-05 08:39:24.0[/d][t]1[/t][d]2018-12-05 00:37:02.0[/d][t]2[/t][d]2018-12-05 00:37:02.0[/d][t]2[/t][d]2018-12-04 16:40:21.0[/d][t]1[/t][d]2018-12-04 16:40:21.0[/d][t]2[/t][d]2018-12-01 10:15:19.0[/d][t]1[/t][d]2018-12-01 10:15:19.0[/d][t]2[/t][d]2018-12-01 20:47:55.0[/d][t]1[/t][d]2018-12-01 20:47:55.0[/d][t]2[/t][d]2018-12-01 19:29:22.0[/d][t]1[/t][d]2018-12-01 19:29:22.0[/d][t]2[/t][d]2018-12-01 19:29:22.0[/d][t]2[/t][d]2018-12-01 19:29:22.0[/d][t]2[/t][d]2018-12-01 19:29:22.0[/d][t]2[/t][d]2018-12-01 19:29:22.0[/d][t]2[/t][d]2018-12-06 03:35:43.0[/d][t]2[/t][d]2018-12-06 03:35:43.0[/d][t]1[/t][d]2018-12-06 03:35:43.0[/d][t]2[/t][d]2018-12-06 03:35:43.0[/d][t]2[/t][d]2018-12-06 03:26:59.0[/d][t]2[/t][d]2018-12-06 03:26:59.0[/d][t]1[/t][d]2018-12-06 03:26:59.0[/d][t]2[/t][d]2018-12-06 03:17:21.0[/d][t]1[/t][d]2018-12-06 03:17:21.0[/d][t]2[/t][d]2018-12-06 03:17:21.0[/d][t]2[/t][d]2018-12-06 03:17:21.0[/d][t]1[/t][d]2018-12-06 03:17:21.0[/d][t]1[/t][d]2018-12-05 18:06:12.0[/d][t]2[/t][d]2018-12-05 18:06:12.0[/d]"""
        input_xml_str = input_xml_str1 + input_xml_str2 + input_xml_str3
        d = parser_space_xml(input_xml_str)
        df = get_final_df(d)
        print(df)


if __name__ == '__main__':
    unittest.main()
